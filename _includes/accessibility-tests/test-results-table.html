<!-- Set svg classes -->
{% assign svg_wrapper_classes = "display-flex flex-align-center" %}
{% assign svg_classes = "usa-icon font-body-2xs minh-205 minw-205 margin-right-05" %}

<!-- Create a list of each status type -->
{% assign statusTypes = "Passed, Passed with exceptions, Conditional, Failed" | split: ", " %}

<!-- Set status icons -->
{% assign pass_icon = 'check_circle' %}
{% assign exceptions_icon = 'warning' %}
{% assign fail_icon = 'cancel' %}
{% assign conditional_icon = 'info' %}

<!-- Count the number of items for each status type -->
{% assign items = component.testItems %}
{% assign itemsTotal = 0 %}
{% assign itemsPass = 0 %}
{% assign itemsException = 0 %}
{% assign itemsFail = 0 %}
{% assign itemsExempt = 0 %}
{% for item in items %}
  {% capture itemsTotal %}{{ itemsTotal | plus:1 }}{% endcapture %}
  {% if item.testStatus == "pass" %}
    {% capture itemsPass %}{{ itemsPass | plus:1 }}{% endcapture %}
  {% elsif item.testStatus == "pass-ish" %}
    {% capture itemsException %}{{ itemsException | plus:1 }}{% endcapture %}
  {% elsif item.testStatus == "fail" %}
    {% capture itemsFail %}{{ itemsFail | plus:1 }}{% endcapture %}
  {% elsif item.testStatus == "exempt" %}
    {% capture itemsExempt %}{{ itemsExempt | plus:1 }}{% endcapture %}
  {% endif %}
{% endfor %}

{% assign borderColor = "gray-30" %}
{% assign headerBackgroundColor = "gray-5" %}

<!-- Add test summary for desktop widths -->
<table class="usa-table site-checklist-status-table">
  <caption>
    Overview of recent accessibility test results:
  </caption>
  <thead>
    <tr>
      <th class="border-{{ borderColor }} bg-{{ headerBackgroundColor }}">Total tests</th>
      {% for status in statusTypes %}
        {% if status == "Passed" %}
          {% assign statusIcon = pass_icon %}
          {% assign iconColor = "pass" %}
        {% elsif status == "Passed with exceptions" %}
          {% assign statusIcon = exceptions_icon %}
          {% assign iconColor = "pass-ish" %}
        {% elsif status == "Conditional" %}
          {% assign statusIcon = conditional_icon %}
          {% assign iconColor = "exempt" %}
        {% elsif status == "Failed" %}
          {% assign statusIcon = fail_icon %}
          {% assign iconColor = "fail" %}
        {% endif %}
        <th class="border-{{ borderColor }} bg-{{ headerBackgroundColor }}">
          <div class="{{ svg_wrapper_classes }}">
              <svg class="{{ svg_classes }} site-checklist-icon--{{ iconColor | downcase }}" aria-hidden="true" role="img">
                <use xlink:href="{{ site.baseurl }}/assets/img/sprite.svg#{{ statusIcon }}"></use>
              </svg>
            {{ status }}
          </div>
        </th>
      {% endfor %}
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class="text-bold bg-{{ headerBackgroundColor }} border-{{ borderColor }}">{{ itemsTotal }}</td>
      {% for status in statusTypes %}
        {% if status == "Passed" %}
          {% assign itemCount = itemsPass %}
        {% elsif status == "Passed with exceptions" %}
          {% assign itemCount = itemsException %}
        {% elsif status == "Failed" %}
          {% assign itemCount = itemsFail %}
        {% elsif status == "Conditional" %}
          {% assign itemCount = itemsExempt %}
        {% endif %}
        <td class="border-{{ borderColor }}">{{ itemCount | default:0 }}</td>
      {% endfor %}
    </tr>
  </tbody>
</table>

<!-- Add test summary for mobile widths -->
<div class="site-checklist-status-list">
  <p class="font-sans-xs text-bold">Overview of recent accessibility test results:</p>

  <ul class="usa-icon-list margin-top-0">
    {% for status in statusTypes %}
      {% if status == "Passed" %}
        {% assign statusIcon = pass_icon %}
        {% assign iconColor = "pass" %}
        {% assign itemCount = itemsPass %}
        {% assign statusText = "Passed" %}
      {% elsif status == "Passed with exceptions" %}
        {% assign statusIcon = exceptions_icon %}
        {% assign iconColor = "pass-ish" %}
        {% assign itemCount = itemsException %}
        {% assign statusText = "Passed with exceptions" %}
      {% elsif status == "Failed" %}
        {% assign statusIcon = fail_icon %}
        {% assign iconColor = "fail" %}
        {% assign itemCount = itemsFail %}
        {% assign statusText = "Failed" %}
      {% elsif status == "Conditional" %}
        {% assign statusIcon = conditional_icon %}
        {% assign iconColor = "exempt" %}
        {% assign itemCount = itemsExempt %}
        {% assign statusText = "Conditional" %}
      {% endif %}

      {% assign items = "items" %}
      {% if itemCount == "1" %}
        {% assign items = "item" %}
      {% endif %}

      <li class="usa-icon-list__item">
        <div class="usa-icon-list__icon site-checklist-icon--{{ iconColor | downcase }}">
          <svg class="usa-icon" aria-hidden="true" role="img">
            <use xlink:href="{{ site.baseurl }}/assets/img/sprite.svg#{{ statusIcon }}"></use>
          </svg>
        </div>
        <div class="usa-icon-list__content">
          <b>Tests {{ statusText | default:status | downcase }}:</b> {{ itemCount }}
        </div>
      </li>
    {% endfor %}
  </ul>
</div>
