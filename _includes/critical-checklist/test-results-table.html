<!-- Set svg classes -->
{% assign svg_wrapper_classes = "display-flex flex-align-center" %}
{% assign svg_classes = "usa-icon font-body-xs minh-205 minw-205 margin-right-05" %}

<!-- Create a list of each status type -->
{% assign statusTypes = "Pass, Pass with exceptions, Conditional, Fail" | split: ", " %}

<!-- Set status icons -->
{% assign passIcon = 'check_circle' %}
{% assign passIshIcon = 'warning' %}
{% assign failIcon = 'cancel' %}
{% assign conditionalIcon = 'info' %}

<!-- Count the number of items for each status type -->
{% assign items = component.testItems %}
{% assign itemsTotal = 0 %}
{% assign itemsPass = 0 %}
{% assign itemsPassIsh = 0 %}
{% assign itemsFail = 0 %}
{% assign itemsExempt = 0 %}
{% for item in items %}
  {% capture itemsTotal %}{{ itemsTotal | plus:1 }}{% endcapture %}
  {% if item.testStatus == "pass" %}
    {% capture itemsPass %}{{ itemsPass | plus:1 }}{% endcapture %}
  {% elsif item.testStatus == "pass-ish" %}
    {% capture itemsPassIsh %}{{ itemsPassIsh | plus:1 }}{% endcapture %}
  {% elsif item.testStatus == "fail" %}
    {% capture itemsFail %}{{ itemsFail | plus:1 }}{% endcapture %}
  {% elsif item.testStatus == "exempt" %}
    {% capture itemsExempt %}{{ itemsExempt | plus:1 }}{% endcapture %}
  {% endif %}
{% endfor %}

{% assign borderColor = "gray-50" %}
{% assign headerBackgroundColor = "gray-10" %}

<!-- Add test summary for desktop widths -->
<table class="usa-table text-center display-none tablet:display-block font-sans-xs">
  <caption>
    Overview of recent accessibility test results:
  </caption>
  <thead>
    <tr>
      <th class="border-{{ borderColor }} bg-{{ headerBackgroundColor }}">Total tests</th>
      {% for status in statusTypes %}
        {% if status == "Pass" %}
          {% assign statusIcon = passIcon %}
          {% assign iconColor = "pass" %}
        {% elsif status == "Pass with exceptions" %}
          {% assign statusIcon = passIshIcon %}
          {% assign iconColor = "pass-ish" %}
        {% elsif status == "Conditional" %}
          {% assign statusIcon = conditionalIcon %}
          {% assign iconColor = "exempt" %}
        {% elsif status == "Fail" %}
          {% assign statusIcon = failIcon %}
          {% assign iconColor = "fail" %}
        {% endif %}
        <th class="border-{{ borderColor }} bg-{{ headerBackgroundColor }}">
          <div class="{{ svg_wrapper_classes }}">
              <svg class="{{ svg_classes }} site-checklist-icon--{{ iconColor | downcase }}" aria-hidden="true" role="img">
                <use xlink:href="{{ site.baseurl }}/assets/img/sprite.svg#{{ statusIcon }}"></use>
              </svg>
            {{ status }}
          </div>
        </th>
      {% endfor %}
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class="text-bold bg-{{ headerBackgroundColor }} border-{{ borderColor }}">{{ itemsTotal }}</td>
      {% for status in statusTypes %}
        {% if status == "Pass" %}
          {% assign itemCount = itemsPass %}
        {% elsif status == "Pass with exceptions" %}
          {% assign itemCount = itemsPassIsh %}
        {% elsif status == "Fail" %}
          {% assign itemCount = itemsFail %}
        {% elsif status == "Conditional" %}
          {% assign itemCount = itemsExempt %}
        {% endif %}
        <td class="border-{{ borderColor }}">{{ itemCount | default:0 }}</td>
      {% endfor %}
    </tr>
  </tbody>
</table>

<!-- Add test summary for mobile widths -->
<ul class="usa-icon-list margin-top-2 tablet:display-none">
  {% for status in statusTypes %}
    {% if status == "Pass" %}
      {% assign statusIcon = passIcon %}
      {% assign iconColor = "pass" %}
      {% assign itemCount = itemsPass %}
      {% assign statusText = "pass" %}
    {% elsif status == "Pass with exceptions" %}
      {% assign statusIcon = passIshIcon %}
      {% assign iconColor = "pass-ish" %}
      {% assign itemCount = itemsPassIsh %}
      {% assign statusText = "pass with some exceptions" %}
    {% elsif status == "Fail" %}
      {% assign statusIcon = failIcon %}
      {% assign iconColor = "fail" %}
      {% assign itemCount = itemsFail %}
      {% assign statusText = "fail" %}
    {% elsif status == "Conditional" %}
      {% assign statusIcon = conditionalIcon %}
      {% assign iconColor = "exempt" %}
      {% assign itemCount = itemsExempt %}
      {% assign statusText = "cannot be evaluated at the system level" %}
    {% endif %}

    {% assign items = "items" %}
    {% if itemCount == "1" %}
      {% assign items = "item" %}
    {% endif %}

    <li class="usa-icon-list__item">
      <div class="usa-icon-list__icon site-checklist-icon--{{ iconColor | downcase }}">
        <svg class="usa-icon" aria-hidden="true" role="img">
          <use xlink:href="{{ site.baseurl }}/assets/img/sprite.svg#{{ statusIcon }}"></use>
        </svg>
      </div>
      <div class="usa-icon-list__content">
        {{ itemCount }} {{ items }} {{ statusText | default:status | downcase}}
      </div>
    </li>
  {% endfor %}
</ul>
